<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NeoWatt</title>
    <meta name="description" content="NeoWatt - Energy beyond Earth" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root { color-scheme: dark; }
      html, body { height: 100%; }
      body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans"; }
      .bg-deep { background-color: #0b1020; }
      .glow-bl { background: radial-gradient(55% 55% at 0% 100%, rgba(34,197,94,0.18), rgba(34,197,94,0) 60%); }
      .glow-tr { background: radial-gradient(55% 55% at 100% 0%, rgba(249,115,22,0.18), rgba(249,115,22,0) 60%); }
      .underline-gradient { background-image: linear-gradient(to right, rgba(249,115,22,0.9), rgba(34,197,94,0.9)); background-size: 100% 2px; background-repeat: no-repeat; background-position: 0 100%; }
      .focus-ring:focus { outline: none; box-shadow: 0 0 0 4px rgba(255,255,255,0.08); }
      canvas { display:block; }
      a { color: #9bd7ff; }
      a:hover { text-decoration: underline; }
    </style>
  </head>
  <body class="min-h-screen bg-deep text-slate-100 antialiased overflow-hidden">
    <!-- Background layers: corner glows + constellation grid canvas -->
    <div class="fixed inset-0 -z-30 glow-tr"></div>
    <div class="fixed inset-0 -z-30 glow-bl"></div>
    <div id="parallax-wrapper" class="fixed inset-0 -z-20 will-change-transform">
      <canvas id="grid" class="w-full h-full"></canvas>
    </div>

    <main class="relative flex min-h-screen flex-col items-center justify-center p-6">
      <section class="w-full max-w-3xl rounded-2xl bg-white/5 backdrop-blur-md shadow-2xl ring-1 ring-white/10 p-8 md:p-12">
        <!-- Quotes (left-aligned) -->
        <div class="space-y-4 text-left">
          <blockquote class="text-xl md:text-2xl text-slate-200 font-semibold leading-relaxed">
            <span>Elon Musk:</span>
            <a href="https://www.youtube.com/watch?v=9YZVAMh8b0s" target="_blank" rel="noopener" class="text-slate-200 no-underline">“Space solar power, the stupidest thing ever”</a>
          </blockquote>
          <blockquote class="text-xl md:text-2xl text-slate-200 font-semibold leading-relaxed">
            <span>NeoWatt:</span>
            <span class="ml-2">“Hold my beer”</span>
          </blockquote>
        </div>

        <!-- Brand (centered) -->
        <div class="mt-10 text-center">
          <h1 class="text-4xl md:text-6xl font-black tracking-tight">NeoWatt</h1>
          <p class="mt-3 text-lg md:text-xl text-white inline-block">Energy beyond Earth</p>
        </div>

        <!-- CTA (centered) -->
        <div class="mt-10 md:mt-12 text-center">
          <form id="signup-form" class="mt-4 flex flex-col sm:flex-row gap-3 justify-center">
            <label for="email" class="sr-only">Email address</label>
            <input id="email" name="email" type="email" required autocomplete="email" placeholder="Email" class="focus-ring w-full sm:w-72 rounded-xl bg-white/10 text-slate-100 placeholder-slate-400 px-4 py-3 ring-1 ring-white/15" />
            <!-- Subtler button colour -->
            <button type="submit" class="rounded-xl px-5 py-3 font-semibold ring-1 ring-white/10 shadow-lg bg-white/15 text-slate-100 hover:bg-white/20 active:bg-white/25 transition">
              Get updates
            </button>
          </form>
        </div>
      </section>

      <footer class="mt-8 text-xs text-slate-500 text-center flex items-center justify-center gap-1 flex-wrap">
        © <span id="year"></span> NeoWatt Ltd · 
        <a href="mailto:matthew.allcock@neowatt.co.uk">matthew.allcock@neowatt.co.uk</a>
        · Supported by
        <img src="UKSA_logo.png" alt="UK Space Agency Logo" style="width: 70px; vertical-align: middle; margin-left: 0.3em;" />
      </footer>
    </main>

    <script>
      // Footer year
      document.getElementById('year').textContent = new Date().getFullYear();

      // Apps Script endpoint (POST only). Server will dedupe.
      const scriptURL = 'https://script.google.com/macros/s/AKfycbwp6yVhEvSS5paW-viO8SgCOGNKb2QHhi27FByRXu7LCUHovFD1-ND59oTq7-cRG76EbA/exec';

      // Simplified submit: validate → POST (opaque) → thank-you UI
      const formEl = document.getElementById('signup-form');
      formEl.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value.trim();
        if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
          formEl.innerHTML = "<p class='text-red-300 mt-3'>Please enter a valid email address.</p>";
          return;
        }
        // Fire-and-forget POST; Apps Script handles duplicates server-side
        fetch(scriptURL, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        }).catch(() => {});

        formEl.innerHTML = "<p class='text-emerald-300 mt-3'>Thanks! We'll send you updates.</p>";
      });

      // ------------------------------
      // Constellation Grid Background
      // ------------------------------
      (function() {
        const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        const canvas = document.getElementById('grid');
        const ctx = canvas.getContext('2d');
        const wrapper = document.getElementById('parallax-wrapper');
        let w = 0, h = 0;

        // Node config (lean for perf)
        const NODE_COUNT = 80;
        const MAX_LINK_DIST = 140;
        const CURSOR_LINK_DIST = 160;
        const CURSOR_LINKS_MAX = 10;
        const SPEED = 2.0; // adjust for faster/slower motion
        const nodes = [];
        let mouse = { x: null, y: null, active: false };

        function resize() {
          const { innerWidth, innerHeight } = window;
          w = innerWidth; h = innerHeight;
          canvas.width = Math.floor(w * DPR);
          canvas.height = Math.floor(h * DPR);
          canvas.style.width = w + 'px';
          canvas.style.height = h + 'px';
          ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
        }

        function rand(min, max) { return Math.random() * (max - min) + min; }

        function initNodes() {
          nodes.length = 0;
          for (let i = 0; i < NODE_COUNT; i++) {
            nodes.push({
              x: rand(0, w),
              y: rand(0, h),
              vx: rand(-0.05, 0.05),
              vy: rand(-0.05, 0.05),
              r: rand(0.6, 1.6),
              hue: Math.random() < 0.25 ? 32 : 0,
            });
          }
        }

        function step() {
          ctx.clearRect(0, 0, w, h);

          if (mouse.active) {
            const px = (mouse.x / w - 0.5) * 6;
            const py = (mouse.y / h - 0.5) * 6;
            wrapper.style.transform = `translate3d(${-px}px, ${-py}px, 0)`;
          }

          for (const n of nodes) {
            n.x += n.vx * SPEED; n.y += n.vy * SPEED;
            if (n.x < -5) n.x = w + 5; else if (n.x > w + 5) n.x = -5;
            if (n.y < -5) n.y = h + 5; else if (n.y > h + 5) n.y = -5;
          }

          for (let i = 0; i < nodes.length; i++) {
            const a = nodes[i];
            for (let j = i + 1; j < nodes.length; j++) {
              const b = nodes[j];
              const dx = a.x - b.x, dy = a.y - b.y;
              const d2 = dx*dx + dy*dy;
              const maxd = MAX_LINK_DIST;
              if (d2 < maxd*maxd) {
                const d = Math.sqrt(d2);
                const alpha = 1 - d / maxd;
                ctx.beginPath();
                ctx.moveTo(a.x, a.y);
                ctx.lineTo(b.x, b.y);
                ctx.lineWidth = 1;
                ctx.globalAlpha = alpha * 0.35;
                ctx.strokeStyle = 'rgba(255,255,255,1)';
                ctx.shadowColor = 'rgba(255,180,80,0.15)';
                ctx.shadowBlur = 2;
                ctx.stroke();
                ctx.shadowBlur = 0;
                ctx.globalAlpha = 1;
              }
            }
          }

          if (mouse.active && mouse.x !== null) {
            const candidates = [];
            for (const n of nodes) {
              const dx = n.x - mouse.x, dy = n.y - mouse.y;
              const d2 = dx*dx + dy*dy;
              if (d2 < CURSOR_LINK_DIST * CURSOR_LINK_DIST) candidates.push({ n, d2 });
            }
            candidates.sort((a, b) => a.d2 - b.d2);
            const K = Math.min(CURSOR_LINKS_MAX, candidates.length);

            for (let i = 0; i < K; i++) {
              const { n, d2 } = candidates[i];
              const d = Math.sqrt(d2);
              const alpha = 1 - d / CURSOR_LINK_DIST;
              ctx.beginPath();
              ctx.moveTo(mouse.x, mouse.y);
              ctx.lineTo(n.x, n.y);
              ctx.lineWidth = 1.1;
              ctx.globalAlpha = Math.min(0.55, 0.15 + alpha * 0.6);
              ctx.strokeStyle = 'rgba(255,200,120,1)';
              ctx.shadowColor = 'rgba(255,170,80,0.35)';
              ctx.shadowBlur = 4;
              ctx.stroke();
              ctx.shadowBlur = 0;
              ctx.globalAlpha = 1;
            }
          }

          for (const n of nodes) {
            ctx.beginPath();
            ctx.arc(n.x, n.y, n.r, 0, Math.PI * 2);
            const color = n.hue === 32 ? 'rgba(255,173,94,0.95)' : 'rgba(255,255,255,0.9)';
            ctx.fillStyle = color;
            ctx.shadowColor = n.hue === 32 ? 'rgba(255,160,80,0.45)' : 'rgba(255,255,255,0.25)';
            ctx.shadowBlur = 6;
            ctx.fill();
            ctx.shadowBlur = 0;
          }

          requestAnimationFrame(step);
        }

        function onMove(evt) {
          const rect = canvas.getBoundingClientRect();
          mouse.x = evt.clientX - rect.left;
          mouse.y = evt.clientY - rect.top;
          mouse.active = true;
        }
        function onLeave() { mouse.active = false; }

        window.addEventListener('resize', () => { resize(); initNodes(); });
        window.addEventListener('orientationchange', () => { resize(); initNodes(); });
        canvas.addEventListener('mousemove', onMove, { passive: true });
        canvas.addEventListener('mouseenter', onMove, { passive: true });
        canvas.addEventListener('mouseleave', onLeave, { passive: true });
        document.addEventListener('mousemove', onMove, { passive: true });

        resize();
        initNodes();
        requestAnimationFrame(step);
      })();

      // ------------------------------
      // Tiny dev self-tests (console-only)
      // ------------------------------
      ;(function devTests(){
        try {
          // Email regex spot-checks
          console.assert(/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test('user@example.com'), 'Valid email should pass');
          console.assert(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test('not-an-email'), 'Invalid email should fail');

          // POST body structure
          const body = JSON.stringify({ email: 'user@example.com' });
          console.assert(body.includes('user@example.com'), 'POST body should include email');
        } catch(e) { /* ignore in prod */ }
      })();
    </script>
  </body>
</html>
